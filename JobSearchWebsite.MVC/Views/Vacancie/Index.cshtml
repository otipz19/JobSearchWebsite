@using Data.Entities;
@using Data.Enums;
@using Utility.Services.Checkbox;
@model Utility.ViewModels.VacancieIndexListVm
@{
    ViewData["Title"] = "Index";
}

<div class="container">
    <form method="get" asp-action="Index">
    <div class="row">
        <div class="col-sm-6">
            <h3 class="display-3">@Model.TotalVacancies @(Model.TotalVacancies == 1 ? "Vacancie" : "Vacancies")</h3>
        </div>
        @if (User.IsCompany())
        {
            <div class="col-sm-6 d-flex justify-content-end align-items-center">
                <a asp-action="Create" class="btn btn-outline-primary">
                    Create new vacancie
                </a>
            </div>
        }
    </div>

    <hr />

    <div class="row gx-5 mt-4">
        
        @*Search/Filter/Sort form*@
        <div class="col-sm-4">
                <div class="row mb-3">
                    <div class="col-sm-6">
                        <button type="submit" class="form-control btn btn-outline-primary">
                            Search
                        </button>
                    </div>
                    <div class="col-sm-6">
                        <a asp-action="Index" class="form-control btn btn-outline-secondary">Reset</a>
                    </div>
                </div>

                <div class="row mb-3">
                    <label class="form-label">Search by title</label>
                    <input asp-for="Filter.SearchQuery" type="text" class="form-control ms-2"/>
                </div>

                <div class="row mb-3">
                    <label class="form-label">Salary bounds</label>
                    <div class="input-group">
                        <span class="input-group-text">From</span>
                        <input asp-for="Filter.SalaryFrom" type="number" class="form-control" />
                        <span class="input-group-text">To</span>
                        <input asp-for="Filter.SalaryTo" type="number" class="form-control" />
                    </div>
                </div>

                @{
                    var keywordsModel = new IndexCheckboxPartialVm(Model.Filter.CheckboxKeywords, "Keywords", $"{nameof(Model.Filter)}.{nameof(Model.Filter.KeywordsId)}");
                    var spheresModel = new IndexCheckboxPartialVm(Model.Filter.CheckboxSpheres, "Spheres", $"{nameof(Model.Filter)}.{nameof(Model.Filter.SpheresId)}");
                    var specializationModel = new IndexCheckboxPartialVm(Model.Filter.CheckboxSpecializations, "Specializations", $"{nameof(Model.Filter)}.{nameof(Model.Filter.SpecializationsId)}");
                    var experienceModel = new IndexCheckboxPartialVm(Model.Filter.CheckboxExperienceLevels, "Experience level", $"{nameof(Model.Filter)}.{nameof(Model.Filter.ExperienceLevelsId)}");
                    var englishModel = new IndexCheckboxPartialVm(Model.Filter.CheckboxEnglishLevels, "English level", $"{nameof(Model.Filter)}.{nameof(Model.Filter.EnglishLevelsId)}");
                    var remotenessModel = new IndexCheckboxPartialVm(Model.Filter.CheckboxRemotenesses, "Remoteness", $"{nameof(Model.Filter)}.{nameof(Model.Filter.RemotenessesId)}");
                    var statesModel = new IndexCheckboxPartialVm(Model.Filter.CheckboxStates, "States", $"{nameof(Model.Filter)}.{nameof(Model.Filter.StatesId)}");
                    var citiesModel = new IndexCheckboxPartialVm(Model.Filter.CheckboxCities, "Cities", $"{nameof(Model.Filter)}.{nameof(Model.Filter.CitiesId)}");
                }
                <partial name="_IndexCheckboxListPartial" model="keywordsModel" />
                <partial name="_IndexCheckboxListPartial" model="spheresModel" />
                <partial name="_IndexCheckboxListPartial" model="specializationModel" />
                <partial name="_IndexCheckboxListPartial" model="experienceModel" />
                <partial name="_IndexCheckboxListPartial" model="englishModel" />
                <partial name="_IndexCheckboxListPartial" model="remotenessModel" />
                <partial name="_IndexCheckboxListPartial" model="statesModel" />
                <partial name="_IndexCheckboxListPartial" model="citiesModel" />

                <div class="row mb-3">
                    <div class="col-sm-6">
                        <button type="submit" class="form-control btn btn-outline-primary">
                            Search
                        </button>
                    </div>
                    <div class="col-sm-6">
                        <a asp-action="Index" class="form-control btn btn-outline-secondary">Reset</a>
                    </div>
                </div>
            
        </div>

        <div class="col-sm-8">
            <div class="d-flex justify-content-between mb-3">
                @if (!Model.IsPreviousDisabled)
                {
                    <input asp-route-Id="@(Model.CurrentPage - 1)" type="submit" value="Previous page" class="form-control btn btn-outline-primary" />
                }
                else
                {
                    <input value="Previous page" class="form-control btn btn-outline-primary" disabled />
                }
                @if (!Model.IsNextDisabled)
                {
                    <input asp-route-Id="@(Model.CurrentPage + 1)" type="submit" value="Next page" class="form-control btn btn-outline-primary" />
                }
                else
                {
                    <input value="Next page" class="form-control btn btn-outline-primary" disabled />
                }
            </div>

            <div class="list-group">
                @foreach (VacancieIndexVm viewModel in Model.Vacancies)
                {
                    <div class="list-group-item">
                        <div class="d-flex w-100 justify-content-between">
                            <h5 class="mb-1">
                                <a asp-action="Details" asp-route-id="@viewModel.Id" class="link-underline link-underline-opacity-0">@viewModel.Name</a>
                            </h5>
                            <small>@viewModel.CreatedAgo</small>
                        </div>
                        <p class="mb-1">
                            @viewModel.ShortDescription
                        </p>
                        <div>
                            <a asp-action="Details" asp-route-id="@viewModel.Id" class="link-underline link-underline-opacity-0">Details</a>
                        </div>
                        <small class="text-muted">And some small print.</small>
                    </div>
                }
            </div>
        </div>

    </div>

    </form>
</div>

